<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="This article proposes a novel architecture, NeuroGrammer, designed to tackle the Abstraction and Reasoning Corpus (ARC) challenge by François Chollet. The architecture combines a differentiable programmer and a neural computer to learn and generalize from examples."><title>Alexey Borsky | NeuroGrammer — a proposal of an architecture for solving the ARC challenge.</title><link rel=canonical href=https://volotat.github.io/p/neurogrammer-architecture-arc-challenge/><link rel=stylesheet href=/scss/style.min.833d6eed45de56f48306bf57268d5b8cdfc8a60e8e7bdc99810464fcd033f7c6.css><meta property='og:title' content="NeuroGrammer — a proposal of an architecture for solving the ARC challenge."><meta property='og:description' content="This article proposes a novel architecture, NeuroGrammer, designed to tackle the Abstraction and Reasoning Corpus (ARC) challenge by François Chollet. The architecture combines a differentiable programmer and a neural computer to learn and generalize from examples."><meta property='og:url' content='https://volotat.github.io/p/neurogrammer-architecture-arc-challenge/'><meta property='og:site_name' content='Alexey Borsky'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='ARC-AGI'><meta property='article:tag' content='Machine Learning'><meta property='article:published_time' content='2022-07-07T00:00:00+00:00'><meta property='article:modified_time' content='2022-07-07T00:00:00+00:00'><meta name=twitter:title content="NeuroGrammer — a proposal of an architecture for solving the ARC challenge."><meta name=twitter:description content="This article proposes a novel architecture, NeuroGrammer, designed to tackle the Abstraction and Reasoning Corpus (ARC) challenge by François Chollet. The architecture combines a differentiable programmer and a neural computer to learn and generalize from examples."><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_e5db16934e59d865.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Alexey Borsky</a></h1><h2 class=site-description>Self taught programmer and ML engineer. Active open-source contributor. Mostly interested in procedural generation and generative AI.</h2></div></header><ol class=menu-social><li><a href=https://github.com/volotat target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/volotat target=_blank title=X rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-x"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg></a></li><li><a href=https://www.youtube.com/@volotat target=_blank title=YouTube rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-youtube"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M2 8a4 4 0 014-4h12a4 4 0 014 4v8a4 4 0 01-4 4H6a4 4 0 01-4-4V8z"/><path d="M10 9l5 3-5 3z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/projects/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-file-code"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 001 1h4"/><path d="M17 21H7a2 2 0 01-2-2V5a2 2 0 012-2h7l5 5v11a2 2 0 01-2 2z"/><path d="M10 13l-1 2 1 2"/><path d="M14 13l1 2-1 2"/></svg>
<span>Projects</span></a></li><li><a href=/archives/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-notebook"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 4h11a2 2 0 012 2v12a2 2 0 01-2 2H6a1 1 0 01-1-1V5a1 1 0 011-1m3 0v18"/><path d="M13 8h2"/><path d="M13 12h2"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/ideas/ style=background-color:#e69326;color:#fff>Ideas</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/neurogrammer-architecture-arc-challenge/>NeuroGrammer — a proposal of an architecture for solving the ARC challenge.</a></h2><h3 class=article-subtitle>This article proposes a novel architecture, NeuroGrammer, designed to tackle the Abstraction and Reasoning Corpus (ARC) challenge by François Chollet. The architecture combines a differentiable programmer and a neural computer to learn and generalize from examples.</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2022-07-07T00:00:00Z>Jul 07, 2022</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>2 minute read</time></div></footer></div></header><section class=article-content><p>Disclaimer: this text is prepared for readers who already familiar with the ARC challenge. If you don’t know what it is, you can take a look at <a class=link href=https://github.com/fchollet/ARC target=_blank rel=noopener>the github page of the challenge</a> and <a class=link href=https://arxiv.org/abs/1911.01547 target=_blank rel=noopener>the original paper “On the Measure of Intelligence”</a> by François Chollet.</p><p>The main idea is to produce a system that consists of two differentiable parts — a programmer and a computer.</p><p>The first part of the system — programmer — takes three inputs: an input data that should be processed, an output data that should be generated and the current state of the program that supposed to covent an input data into an output data. The task of the programmer is to generate a better version of the program.</p><p><img src=/p/neurogrammer-architecture-arc-challenge/1_PIA7-UG3vs5eDFc4_Uu0rg.png width=376 height=506 srcset="/p/neurogrammer-architecture-arc-challenge/1_PIA7-UG3vs5eDFc4_Uu0rg_hu_4775938ab673f87d.png 480w, /p/neurogrammer-architecture-arc-challenge/1_PIA7-UG3vs5eDFc4_Uu0rg_hu_170ff55f17f7ba9.png 1024w" loading=lazy class=gallery-image data-flex-grow=74 data-flex-basis=178px></p><p>The second part of the system — computer — takes two inputs: an input data and the program. The task of the computer is to apply the program to the input data and produce an output.</p><p><img src=/p/neurogrammer-architecture-arc-challenge/1_juw57YNOwhc9IWZcFOkggQ.png width=378 height=503 srcset="/p/neurogrammer-architecture-arc-challenge/1_juw57YNOwhc9IWZcFOkggQ_hu_65a9b49d2b6e233f.png 480w, /p/neurogrammer-architecture-arc-challenge/1_juw57YNOwhc9IWZcFOkggQ_hu_6f1f8b8286247e0e.png 1024w" loading=lazy class=gallery-image data-flex-grow=75 data-flex-basis=180px></p><p>In actuality the programmer and the computer are both the neural networks and the program is a N-dimensional vector. Because both of the parts are differentiable we could backpropagate through the whole system to train both programmer and computer to work coherently. Furthermore we may propagate through several steps of the pipeline to get better results. With this architecture we could have a system that may take an arbitrary number of examples and produce a solution to a new input based on the program it comes up with.</p><p>To test this idea I created a small dataset resembling the ARC, that was partially created by hand and partially generated on the fly, but with some additional restrictions: all tasks have 6x6 grids, each cell has only two states (black and white), all tasks have exactly 5 examples.</p><p>Here is a little glimpse of how the network performed on the tasks:</p><p><img src=/p/neurogrammer-architecture-arc-challenge/1_D8LE7ETBIURSQyBYaEUl9g.png width=2400 height=410 srcset="/p/neurogrammer-architecture-arc-challenge/1_D8LE7ETBIURSQyBYaEUl9g_hu_a8a43799b06fa8a2.png 480w, /p/neurogrammer-architecture-arc-challenge/1_D8LE7ETBIURSQyBYaEUl9g_hu_4f4c9f24c6bcbffe.png 1024w" loading=lazy class=gallery-image data-flex-grow=585 data-flex-basis=1404px></p><p>Each column (3x6) here represent one task. Inside the task first colum represent an input, second — an output and the third — a guess of the networks considering all previous examples and current input given.</p><p>In my experiments this system worked really well for procedurally generated tasks, a bit worse on the in distribution data and horrible on the out of distribution data. In other words, it could solve the type of tasks it saw, but almost always failed on novel ones. Although the scale of the experiments was miniscule and all networks were composed of several fully-connected layers, so there are still a potential to make it work.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/arc-agi/>ARC-AGI</a>
<a href=/tags/machine-learning/>Machine Learning</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=[".main-article",".widget--toc"];e.forEach(e=>{const t=document.querySelector(e);t&&renderMathInElement(t,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})})</script></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/there-is-a-way-to-make-training-llms-way-cheaper-and-more-accessible/><div class=article-image><img src=/p/there-is-a-way-to-make-training-llms-way-cheaper-and-more-accessible/0_4fPJHVhCQeYNef_n.da92564886320ed49d56f833caf2577a_hu_e2f6d36c91f45fd1.png width=250 height=150 loading=lazy alt="Featured image of post There is a way to make training LLMs way cheaper and more accessible." data-key=there-is-a-way-to-make-training-llms-way-cheaper-and-more-accessible data-hash="md5-2pJWSIYyDtSdVvgzyvJXeg=="></div><div class=article-details><h2 class=article-title>There is a way to make training LLMs way cheaper and more accessible.</h2></div></a></article><article><a href=/p/combining-gpt-3-and-stable-diffusion-to-imagine-a-next-level-game-engine/><div class=article-details><h2 class=article-title>Combining GPT-3 and Stable Diffusion to imagine a next level game engine.</h2></div></a></article><article class=has-image><a href=/p/can-humans-speak-the-language-of-the-machines/><div class=article-image><img src=/p/can-humans-speak-the-language-of-the-machines/0_Tpm0MlWfLdNMGQ9b.16940e0aa6d9e94f6f5a9503d19df360_hu_8e81a329be74c091.png width=250 height=150 loading=lazy alt="Featured image of post Can Humans Speak the Language of the Machines?" data-key=can-humans-speak-the-language-of-the-machines data-hash="md5-FpQOCqbZ6U9vWpUD0Z3zYA=="></div><div class=article-details><h2 class=article-title>Can Humans Speak the Language of the Machines?</h2></div></a></article><article class=has-image><a href=/p/the-sunset-of-human-readable-code/><div class=article-image><img src=/p/the-sunset-of-human-readable-code/0_WnVe9xDIVdAL4WG4.d9feb90c6821f131d33df6e9d654a2c8_hu_f5b068aab46c37b5.png width=250 height=150 loading=lazy alt="Featured image of post The Sunset of Human-Readable Code." data-key=the-sunset-of-human-readable-code data-hash="md5-2f65DGgh8THTPfbp1lSiyA=="></div><div class=article-details><h2 class=article-title>The Sunset of Human-Readable Code.</h2></div></a></article><article class=has-image><a href=/projects/2021-07-26-the-arc-game/><div class=article-image><img src=/projects/2021-07-26-the-arc-game/level_example.6b2b67fff69ddf913417066070849464_hu_29695690bfe443c6.jpg width=250 height=150 loading=lazy alt="Featured image of post The ARC Game" data-hash="md5-aytn//ad35E0FwZgcISUZA=="></div><div class=article-details><h2 class=article-title>The ARC Game</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2017 -
2026 Alexey Borsky</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>